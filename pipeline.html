<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GCanvas Rendering Pipeline Documentation</title>
  <!-- Prism.js - base theme then override -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.css">
  <style>
    /* Terminal-style Prism overrides */
    code[class*="language-"],
    pre[class*="language-"] {
      color: #ccc;
      background: #0a0a0a;
      text-shadow: none;
    }
    pre[class*="language-"] {
      background: #0a0a0a;
      border: 1px solid #1a1a1a;
    }
    .token.comment,
    .token.prolog,
    .token.doctype,
    .token.cdata { color: #555; }
    .token.punctuation { color: #888; }
    .token.property,
    .token.tag,
    .token.constant,
    .token.symbol,
    .token.deleted { color: #0f0; }
    .token.boolean,
    .token.number { color: #0ff; }
    .token.selector,
    .token.attr-name,
    .token.string,
    .token.char,
    .token.builtin,
    .token.inserted { color: #7fff7f; }
    .token.operator,
    .token.entity,
    .token.url,
    .language-css .token.string,
    .style .token.string,
    .token.variable { color: #ccc; }
    .token.atrule,
    .token.attr-value,
    .token.function,
    .token.class-name { color: #0f0; }
    .token.keyword { color: #0f0; font-weight: bold; }
    .token.regex,
    .token.important { color: #fd8; }
  </style>
  <style>
    *, *::before, *::after {
      box-sizing: border-box;
    }

    html, body {
      overflow-x: hidden;
    }

    body {
      font-family: 'Courier New', 'Consolas', monospace;
      line-height: 1.6;
      color: #333;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background-color: #000;
    }

    header {
      margin-bottom: 40px;
      padding: 20px;
      border-bottom: 2px solid #0f0;
    }

    h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      color: #0f0;
      font-family: 'Courier New', monospace;
    }

    h2 {
      font-size: 1.8em;
      margin-top: 40px;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid #0f0;
      color: #0f0;
      font-family: 'Courier New', monospace;
    }

    h3 {
      font-size: 1.4em;
      margin-top: 30px;
      color: #0f0;
      font-family: 'Courier New', monospace;
    }

    h4 {
      font-size: 1.2em;
      margin-top: 20px;
      color: #0f0;
      font-family: 'Courier New', monospace;
    }

    p {
      margin-bottom: 15px;
      color: #aaa;
      font-family: 'Courier New', monospace;
    }

    pre {
      background-color: #0a0a0a;
      color: #ccc;
      padding: 15px;
      border: 1px solid #1a1a1a;
      overflow-x: auto;
      margin: 15px 0;
      font-family: 'Courier New', monospace;
      max-width: 100%;
    }

    code {
      font-family: 'Courier New', monospace;
      background-color: #111;
      color: #0f0;
      padding: 2px 6px;
      border: none;
    }

    pre code {
      background-color: transparent;
      color: #ccc;
      padding: 0;
      border: none;
    }

    .pipeline-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 30px 0;
    }

    .pipeline-steps {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    .pipeline-step {
      background-color: #000;
      color: #0f0;
      padding: 10px 20px;
      border: 1px solid #0f0;
      position: relative;
      font-family: 'Courier New', monospace;
    }

    .pipeline-step:not(:last-child):after {
      content: "→";
      position: absolute;
      right: -15px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 20px;
      color: #0f0;
    }

    .feature-list {
      list-style-type: none;
      padding-left: 0;
    }

    .feature-list li {
      position: relative;
      padding-left: 30px;
      margin-bottom: 10px;
      color: #aaa;
      font-family: 'Courier New', monospace;
    }

    .feature-list li:before {
      content: "> ";
      color: #0f0;
      position: absolute;
      left: 0;
      top: 0;
      font-weight: bold;
    }

    .note {
      background-color: #0a1a0a;
      padding: 15px;
      border-left: 2px solid #0f0;
      margin: 20px 0;
      color: #7fff7f;
    }

    .example {
      background-color: #0a0a0a;
      border: 1px solid #1a1a1a;
      margin: 20px 0;
    }

    .example-title {
      font-weight: bold;
      color: #0f0;
      background-color: #050505;
      padding: 10px 15px;
      margin: 0;
      border-bottom: 1px solid #1a1a1a;
      font-family: 'Courier New', monospace;
    }

    .example-code {
      padding: 15px;
      margin: 0;
      border-radius: 0;
    }

    .canvas-demo {
      width: 100%;
      height: 250px;
      background-color: #050505;
      border-top: 1px solid #1a1a1a;
      position: relative;
      overflow: hidden;
    }

    .canvas-demo canvas {
      display: block;
      width: 100%;
      height: 100%;
      border: 1px solid #1a1a1a;
    }

    .canvas-label {
      position: absolute;
      bottom: 10px;
      right: 10px;
      background-color: rgba(0, 0, 0, 0.8);
      color: #0f0;
      padding: 4px 8px;
      font-size: 12px;
      font-family: 'Courier New', monospace;
    }

    .shape-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }

    .shape-item {
      background-color: #0a0a0a;
      border: 1px solid #1a1a1a;
      padding: 15px;
      text-align: center;
      font-family: 'Courier New', monospace;
    }

    .shape-item h4 {
      margin-top: 0;
    }

    .shape-item h5 {
      color: #0f0;
      margin: 0 0 10px 0;
      font-family: 'Courier New', monospace;
    }

    .shape-item p {
      margin: 0;
      font-size: 0.9em;
      color: #999;
      font-family: 'Courier New', monospace;
    }

    @media (max-width: 768px) {
      .pipeline-steps {
        flex-direction: column;
      }

      .pipeline-step:not(:last-child):after {
        content: "↓";
        position: absolute;
        bottom: -20px;
        left: 50%;
        transform: translateX(-50%);
        right: auto;
        top: auto;
      }
    }
  </style>

  <!-- SEO:injected -->
  <meta name="description" content="GCanvas Rendering Pipeline Documentation - Interactive demo built with GCanvas, a modular 2D canvas rendering and game framework." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://gcanvas.guinetik.com/pipeline.html" />
  <meta property="og:title" content="GCanvas Rendering Pipeline Documentation" />
  <meta property="og:description" content="GCanvas Rendering Pipeline Documentation - Interactive demo built with GCanvas, a modular 2D canvas rendering and game framework." />
  <meta property="og:image" content="https://gcanvas.guinetik.com/og_image.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="GCanvas Rendering Pipeline Documentation" />
  <meta name="twitter:description" content="GCanvas Rendering Pipeline Documentation - Interactive demo built with GCanvas, a modular 2D canvas rendering and game framework." />
  <meta name="twitter:image" content="https://gcanvas.guinetik.com/og_image.png" />
  <meta name="twitter:creator" content="@guinetik" />
  <link rel="canonical" href="https://gcanvas.guinetik.com/pipeline.html" />
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-1GHJD0LM4Z"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-1GHJD0LM4Z');
  </script>
</head>

<body>
  <header>
    <h1>GCanvas Rendering Pipeline</h1>
    <p>A comprehensive guide to understanding the shape rendering architecture</p>
  </header>

  <section>
    <h2>Overview</h2>
    <p>
      GCanvas is a modular 2D rendering and game framework built on top of the HTML5 Canvas API. At its core, it uses a
      layered approach to rendering that provides a clean, declarative way to draw and manipulate shapes on the canvas.
    </p>
    <p>
      The rendering pipeline in GCanvas follows a hierarchical structure that builds from basic positioning to complex
      visual elements. This hierarchy provides a consistent interface and allows for sophisticated compositions and
      transformations.
    </p>

    <div class="pipeline-container">
      <div class="pipeline-steps">
        <div class="pipeline-step">Euclidian</div>
        <div class="pipeline-step">Geometry2d</div>
        <div class="pipeline-step">Renderable</div>
        <div class="pipeline-step">Transformable</div>
        <div class="pipeline-step">Shape</div>
      </div>
    </div>
  </section>

  <section>
    <h2>The Rendering Pipeline</h2>
    <p>
      The rendering pipeline consists of a chain of classes that inherit from each other, with each layer adding more
      functionality. Let's explore each layer in detail:
    </p>

    <h3 id="euclidian">1. Euclidian</h3>
    <p>
      The <code>Euclidian</code> class is the foundation of all visual elements in GCanvas. It provides the most basic
      properties needed for positioning and sizing objects.
    </p>

    <h4>Key Features:</h4>
    <ul class="feature-list">
      <li>Basic positioning (x, y coordinates)</li>
      <li>Basic dimensions (width, height)</li>
      <li>Debug rendering capabilities</li>
      <li>Property validation to prevent errors</li>
    </ul>

    <div class="example">
      <div class="example-title">Example: Creating a basic Euclidian object</div>
      <pre><code class="language-javascript">// Create a basic Euclidian object
const basicShape = new Euclidian({
  x: 100,
  y: 100,
  width: 50,
  height: 30
});

// Position and size can be accessed and modified
console.log(basicShape.x, basicShape.y); // 100, 100
console.log(basicShape.width, basicShape.height); // 50, 30

// The object validates properties to prevent errors
basicShape.width = 80; // Valid
// basicShape.width = "invalid"; // Error: Invalid property value: width invalid</code></pre>
      <div class="canvas-demo">
        <canvas id="euclidian-canvas"></canvas>
        <div class="canvas-label">Euclidian visualization</div>
      </div>
    </div>

    <h3 id="geometry2d">2. Geometry2d</h3>
    <p>
      The <code>Geometry2d</code> class extends <code>Euclidian</code> by adding spatial constraints and bounding box
      calculations. This allows for controlled positioning and more advanced spatial operations.
    </p>

    <h4>Key Features:</h4>
    <ul class="feature-list">
      <li>Bounds constraints (minX, maxX, minY, maxY)</li>
      <li>Bounds calculation and caching</li>
      <li>Local position calculation</li>
      <li>Crisp rendering option for pixel-perfect alignment</li>
    </ul>

    <div class="example">
      <div class="example-title">Example: Using Geometry2d with constraints</div>
      <pre><code class="language-javascript">// Create a Geometry2d object with constraints
const constrainedShape = new Geometry2d({
  x: 100,
  y: 100,
  width: 50,
  height: 30,
  minX: 50,
  maxX: 150,
  minY: 50,
  maxY: 150,
  crisp: true // Ensures positions and dimensions are whole numbers
});

// Constraints are applied when updating
constrainedShape.x = 40; // Will be constrained to minX (50)
constrainedShape.update();
console.log(constrainedShape.x); // 50

// Get bounding box information
const bounds = constrainedShape.getBounds();
console.log(bounds); // { x: 50, y: 100, width: 50, height: 30 }

// Get local (top-left) position relative to center
const local = constrainedShape.getLocalPosition();
console.log(local); // { x: 25, y: 85 }</code></pre>
      <div class="canvas-demo">
        <canvas id="geometry2d-canvas"></canvas>
        <div class="canvas-label">Geometry2d constraints</div>
      </div>
    </div>

    <h3 id="renderable">3. Renderable</h3>
    <p>
      The <code>Renderable</code> class extends <code>Geometry2d</code> by adding visual properties and rendering
      capabilities. It handles the visibility, opacity, and shadows of visual elements.
    </p>

    <h4>Key Features:</h4>
    <ul class="feature-list">
      <li>Visibility control</li>
      <li>Opacity management</li>
      <li>Shadow effects</li>
      <li>Activity state tracking</li>
      <li>Tick counter for animations</li>
    </ul>

    <div class="example">
      <div class="example-title">Example: Creating a Renderable object with visual properties</div>
      <pre><code class="language-javascript">// Create a Renderable object
const renderableShape = new Renderable({
  x: 100,
  y: 100,
  width: 50,
  height: 30,
  visible: true,
  opacity: 0.7,
  shadowColor: "rgba(0,0,0,0.5)",
  shadowBlur: 5,
  shadowOffsetX: 3,
  shadowOffsetY: 3
});

// Control visibility
renderableShape.visible = false; // Hide the object
renderableShape.visible = true;  // Show the object

// Control opacity (0-1)
renderableShape.opacity = 0.5;   // 50% opacity

// The render() method will apply these properties
// and then call draw() to render the actual shape</code></pre>
      <div class="canvas-demo">
        <canvas id="renderable-canvas"></canvas>
        <div class="canvas-label">Renderable with opacity and shadows</div>
      </div>
    </div>

    <h3 id="transformable">4. Transformable</h3>
    <p>
      The <code>Transformable</code> class extends <code>Renderable</code> by adding transformation capabilities. It
      handles rotation and scaling of visual elements.
    </p>

    <h4>Key Features:</h4>
    <ul class="feature-list">
      <li>Rotation (in radians)</li>
      <li>Scaling (scaleX, scaleY)</li>
      <li>Transform application</li>
      <li>Transformed bounds calculation</li>
    </ul>

    <div class="example">
      <div class="example-title">Example: Applying transformations to an object</div>
      <pre><code class="language-javascript">// Create a Transformable object
const transformableShape = new Transformable({
  x: 100,
  y: 100,
  width: 50,
  height: 30,
  rotation: Math.PI / 4, // 45 degrees
  scaleX: 1.5,
  scaleY: 0.8
});

// Rotation and scaling can be adjusted
transformableShape.rotation = Math.PI / 6; // 30 degrees
transformableShape.scaleX = 2.0;
transformableShape.scaleY = 2.0;

// The applyTransforms() method applies these transformations
// by modifying the canvas context state</code></pre>
      <div class="canvas-demo">
        <canvas id="transformable-canvas"></canvas>
        <div class="canvas-label">Transformable with rotation and scaling</div>
      </div>
    </div>

    <h3 id="shape">5. Shape</h3>
    <p>
      The <code>Shape</code> class extends <code>Transformable</code> and serves as the base class for all visual
      elements in GCanvas. It adds styling properties and is extended by specific shape implementations like
      <code>Circle</code>, <code>Rectangle</code>, etc.
    </p>

    <h4>Key Features:</h4>
    <ul class="feature-list">
      <li>Fill color</li>
      <li>Stroke color and styling</li>
      <li>Line width, join, and cap properties</li>
      <li>Final rendering implementation</li>
    </ul>

    <div class="example">
      <div class="example-title">Example: Creating a Shape with styling properties</div>
      <pre><code class="language-javascript">// Create a Shape object (base class for visual elements)
const shape = new Shape({
  x: 100,
  y: 100,
  width: 50,
  height: 30,
  color: "#ff0000",        // Fill color
  stroke: "#000000",       // Stroke color
  lineWidth: 2,            // Stroke width
  lineJoin: "round",       // Line join style
  lineCap: "round"         // Line cap style
});

// Specific shape classes (Circle, Rectangle, etc.) extend Shape
// and implement their own draw() method 
ctx.fill();
ctx.stroke();
ctx.restore();

// Draw triangle
ctx.save();
ctx.translate(triangle.x, triangle.y);
ctx.beginPath();
ctx.moveTo(0, -triangle.size/2);
ctx.lineTo(triangle.size/2, triangle.size/2);
ctx.lineTo(-triangle.size/2, triangle.size/2);
ctx.closePath();
ctx.fillStyle = triangle.color;
ctx.strokeStyle = triangle.stroke;
ctx.lineWidth = triangle.lineWidth;
ctx.fill();
ctx.stroke();
ctx.restore();</code></pre>
      <div class="canvas-demo">
        <canvas id="shape-canvas"></canvas>
        <div class="canvas-label">Shape implementations (Rectangle, Circle, Triangle)</div>
      </div>
    </div>


    </div>
  </section>
  <section>
    <h2>Available Shapes</h2>
    <p>
      GCanvas provides a variety of shape classes that extend the base <code>Shape</code> class. Each specialized
      shape implements its own <code>draw()</code> method to render the specific geometry.
    </p>

    <div class="shape-grid">
      <div class="shape-item">
        <h4>Circle</h4>
        <p>Circular shape with radius</p>
      </div>
      <div class="shape-item">
        <h4>Rectangle</h4>
        <p>Rectangular shape with width and height</p>
      </div>
      <div class="shape-item">
        <h4>Square</h4>
        <p>Square shape with equal sides</p>
      </div>
      <div class="shape-item">
        <h4>Triangle</h4>
        <p>Triangular shape</p>
      </div>
      <div class="shape-item">
        <h4>Star</h4>
        <p>Star shape with configurable points</p>
      </div>
      <div class="shape-item">
        <h4>Polygon</h4>
        <p>Multi-sided shape</p>
      </div>
      <div class="shape-item">
        <h4>TextShape</h4>
        <p>Text rendering with styling</p>
      </div>
      <div class="shape-item">
        <h4>Heart</h4>
        <p>Heart-shaped geometry</p>
      </div>
      <div class="shape-item">
        <h4>Line</h4>
        <p>Simple line segment</p>
      </div>
      <div class="shape-item">
        <h4>Cross</h4>
        <p>Cross shape</p>
      </div>
      <div class="shape-item">
        <h4>Cloud</h4>
        <p>Cloud-like shape</p>
      </div>
      <div class="shape-item">
        <h4>Cube</h4>
        <p>3D cube with perspective</p>
      </div>
      <div class="shape-item">
        <h4>Cylinder</h4>
        <p>3D cylinder with perspective</p>
      </div>
      <div class="shape-item">
        <h4>Cone</h4>
        <p>3D cone with perspective</p>
      </div>
      <div class="shape-item">
        <h4>Sphere</h4>
        <p>3D sphere with shading</p>
      </div>
      <div class="shape-item">
        <h4>Prism</h4>
        <p>3D prism with perspective</p>
      </div>
      <div class="shape-item">
        <h4>Ring</h4>
        <p>Ring or donut shape</p>
      </div>
      <div class="shape-item">
        <h4>Diamond</h4>
        <p>Diamond shape</p>
      </div>
      <div class="shape-item">
        <h4>SVGPath</h4>
        <p>SVG path rendering</p>
      </div>
    </div>
  </section>

  <section>
    <h2>Composing Shapes with Group</h2>
    <p>
      The <code>Group</code> class is a special container that inherits from <code>Transformable</code>. It allows
      multiple shapes to be grouped together and transformed as a single unit.
    </p>

    <h4>Key Features:</h4>
    <ul class="feature-list">
      <li>Container for multiple shapes</li>
      <li>Coordinates of children are relative to the group</li>
      <li>Transformations (rotation, scale) apply to all children</li>
      <li>Opacity cascades to all children</li>
      <li>Calculates combined bounds based on all children</li>
    </ul>

    <div class="example">
      <div class="example-title">Example: Creating a group of shapes</div>
      <pre><code class="language-javascript">// Create a Group to hold multiple shapes
const group = new Group({
  x: 100,
  y: 100
});

// Add shapes to the group
const rect = new Rectangle({
  width: 100,
  height: 50,
  color: "#ff0000"
});

const circle = new Circle(25, {
  x: 50,
  y: 0,
  color: "#0000ff"
});

const text = new TextShape("Hello", {
  x: 0,
  y: 0,
  color: "#ffffff",
  align: "center",
  baseline: "middle"
});

// Add shapes to the group
group.add(rect);
group.add(circle);
group.add(text);

// Moving the group moves all contained shapes
group.x = 200;
group.y = 150;

// Rotating or scaling the group affects all shapes
group.rotation = Math.PI / 6;  // 30 degrees
group.scaleX = 1.5;
group.scaleY = 1.5;

// Changes to the group's opacity affect all children
group.opacity = 0.7;

// Draw the group and all its children
group.draw();</code></pre>
      <div class="canvas-demo">
        <canvas id="group-canvas"></canvas>
        <div class="canvas-label">Group composition with transformations</div>
      </div>

    </div>
  </section>

  <!-- Prism.js scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>

  <!-- Demo scripts -->
  <script type="module" src="./js/pipeline.js"></script>
</body>

</html>